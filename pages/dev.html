<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Développement - Mon Portfolio</title>
  <link rel="stylesheet" href="../styles/dev-page.css" />
  <link rel="preconnect" href="https://cdnjs.cloudflare.com" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"/>

  <!-- i18n ADD: petit style pour le switch langue (pas de modif du CSS existant) -->
  <style>
    .lang-switch{
      position: fixed; right: 18px; bottom: 18px; z-index: 11000;
      user-select: none; -webkit-tap-highlight-color: transparent;
    }
    .lang-toggle{
      position: relative; display: inline-grid; grid-template-columns: 1fr 1fr;
      width: 120px; height: 40px; padding: 4px; border-radius: 999px;
      background: rgba(255,255,255,.08); border: 1px solid rgba(255,255,255,.2);
      backdrop-filter: blur(8px); font-weight: 800; letter-spacing: .2px;
    }
    .lang-toggle .lang-pill{
      display: grid; place-items: center; font-size: .95rem; color: #e6e6e6;
      z-index: 2;
    }
    .lang-toggle .thumb{
      position: absolute; top: 4px; bottom: 4px; left: 4px;
      width: calc(50% - 4px); border-radius: 999px;
      background: #4cc9f0; color: #1a1a2e; display: grid; place-items: center;
      font-size: .95rem; font-weight: 900;
      transition: transform .28s cubic-bezier(.22,1,.36,1);
      box-shadow: 0 8px 24px rgba(0,0,0,.25);
      pointer-events: none;
    }
    #lang-toggle{ position: absolute; opacity: 0; inset: 0; }
    /* quand coché => EN */
    #lang-toggle:checked + .lang-toggle .thumb{ transform: translateX(100%); }
  </style>
  <!-- /i18n ADD -->
</head>

<body class="dev-theme">
  <!-- Navigation -->
  <nav class="navbar" role="navigation" aria-label="Navigation principale">
    <div class="nav-container">
      <a class="nav-logo" href="javascript:void(0)" 
        onclick="if (document.referrer) { history.back(); } else { window.location.href='../index.html'; }" 
        aria-label="Retour">
        <i class="fas fa-arrow-left" aria-hidden="true"></i>
        <span>Retour</span>
      </a>
      <div class="nav-menu" id="main-menu">
        <a class="nav-link nav-home" href="../index.html">Accueil</a>
        <a class="nav-link" href="#projects">Projets</a>
        <a class="nav-link" href="#skills">Compétences</a>
        <a class="nav-link" href="about.html">À propos</a>
        <a class="nav-link" href="#contact" data-open-contact aria-controls="contact-panel" aria-expanded="false">Contact</a>
      </div>
      <!-- Switch Dev/Créa -->
      <a class="mode-toggle is-dev" aria-label="Basculer entre mode Développeur et Créatif">
        <span class="toggle-half half-dev" aria-current="page">Dev</span>
        <span class="toggle-thumb" aria-hidden="true"></span>
        <span class="toggle-half half-crea" onclick="location.href='creative.html'">Créa</span>
      </a>
      <button class="nav-toggle" id="mobile-menu" aria-label="Ouvrir le menu" aria-controls="main-menu" aria-expanded="false">
        <span class="bar" aria-hidden="true"></span>
        <span class="bar" aria-hidden="true"></span>
        <span class="bar" aria-hidden="true"></span>
      </button>
    </div>
  </nav>
  <header class="dev-hero" id="top">
    <div class="hero-content">
      <div class="hero-intro">
        <span class="hero-greeting">Bonjour, je suis</span>
        <h1 class="hero-title">Ramy Benali</h1>
        <p class="hero-tagline">
          <span class="typewriter">Développeur Fullstack</span>
          <span class="typewriter-cursor" aria-hidden="true">|</span>
        </p>
      </div>

      <p class="hero-description">
        Étudiant en <strong>Master Génie Logiciel</strong>, je m’épanouis dans la création de solutions digitales innovantes.
        Passionné par le développement fullstack, je combine expertise technique et créativité pour transformer
        des concepts complexes en expériences utilisateur exceptionnelles. <strong><a href="about.html">En savoir plus.</a></strong>
      </p>

      <div class="hero-highlights" role="list">
        <div class="highlight-item" role="listitem">
          <i class="fas fa-code" aria-hidden="true"></i>
          <span>Polyvalent et adaptable</span>
        </div>
        <div class="highlight-item" role="listitem">
          <i class="fas fa-lightbulb" aria-hidden="true"></i>
          <span>Créatif et innovant</span>
        </div>
        <div class="highlight-item" role="listitem">
          <i class="fas fa-rocket" aria-hidden="true"></i>
          <span>Dynamique et motivé</span>
        </div>
      </div>

      <div class="hero-actions">
        <a class="cta-btn primary" href="#projects">
          <i class="fas fa-eye" aria-hidden="true"></i>
          <span>Voir mes projets</span>
        </a>
        <a class="cta-btn secondary" href="#contact" data-open-contact aria-controls="contact-panel" aria-expanded="false">
          <i class="fas fa-paper-plane" aria-hidden="true"></i>
          <span>Me contacter</span>
        </a>
        <a class="cta-btn secondary" href="about.html" aria-expanded="false">
          <i class="fas fa-address-card" aria-hidden="true"></i>
          <span>À propos</span>
        </a>
      </div>
    </div>

    <div class="hero-visual" aria-hidden="true">
      <div class="floating-elements">
        <div class="floating-element" data-tech="React"><i class="fab fa-react"></i></div>
        <div class="floating-element" data-tech="Python"><i class="fab fa-python"></i></div>
        <div class="floating-element" data-tech="Java"><i class="fab fa-java"></i></div>
        <div class="floating-element" data-tech="Kotlin"><i class="fas fa-mobile-alt"></i></div>
        <div class="floating-element" data-tech="Node.js"><i class="fab fa-node-js"></i></div>
        <div class="floating-element" data-tech="HTML5"><i class="fab fa-html5"></i></div>
        <div class="floating-element" data-tech="CSS3"><i class="fab fa-css3-alt"></i></div>
        <div class="floating-element" data-tech="JavaScript"><i class="fab fa-js"></i></div>
        <div class="floating-element" data-tech="Git"><i class="fab fa-git-alt"></i></div>
        <div class="floating-element" data-tech="C"><i class="fas fa-c"></i></div>
        <div class="floating-element" data-tech="C++"><i class="fas fa-code"></i></div>
      </div>
    </div>
  </header>

  <!-- Projets -->
  <section id="projects" class="projects-section" aria-labelledby="projects-title">
    <div class="container">
      <h2 class="section-title" id="projects-title">Mes <span class="accent">Projets</span></h2>

      <div class="projects-grid">
        <!-- Project 1 -->
        <article class="project-card">
          <div class="project-image" style="background: linear-gradient(135deg, #1a1a2e 0%, #0f3460 100%);">
            <img class="project-logo-img" src="../assets/images/pong-logo.jpg" alt="Pong Game" />
            <div class="project-overlay" aria-hidden="true">
              <div class="project-tech"><span>C</span><span>Raylib</span></div>
            </div>
          </div>
          <div class="project-content">
            <h3 class="project-title">Pong Game</h3>
            <p class="project-description">Jeu de pong élégant avec design moderne et physique réaliste.</p>
            <div class="project-actions">
              <button class="project-btn" data-project="pong-game" type="button">
                <i class="fas fa-eye" aria-hidden="true"></i>
                <span>Voir le projet</span>
              </button>
              <a class="project-btn secondary" href="https://github.com/RamyBenali/Pong-Game" target="_blank" rel="noopener">
                <i class="fab fa-github" aria-hidden="true"></i>
                <span>Code</span>
              </a>
            </div>
          </div>
        </article>

        <!-- Project 2 -->
        <article class="project-card">
          <div class="project-image" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
            <img class="echoes-logo-img" src="../assets/images/Echoes.jpg" alt="Echoes" />
            <div class="project-overlay" aria-hidden="true">
              <div class="project-tech"><span>HTML5</span><span>React</span><span>JavaScript</span><span>CSS3</span><span>MySQL</span></div>
            </div>
          </div>
          <div class="project-content">
            <h3 class="project-title">Echoes</h3>
            <p class="project-description">Jeu d’énigmes immersif développé pour le club scientifique universitaire.</p>
            <div class="project-actions">
              <button class="project-btn" data-project="echoes" type="button">
                <i class="fas fa-eye" aria-hidden="true"></i>
                <span>Voir le projet</span>
              </button>
            </div>
          </div>
        </article>

        <!-- Project 3 -->
        <article class="project-card">
          <div class="project-image" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">
            <img class="home-inspire-logo-img" src="../assets/images/Home-inspire.jpg" alt="HomeInspire" />
            <div class="project-overlay" aria-hidden="true">
              <div class="project-tech"><span>Java</span><span>JavaFX</span><span>MySQL</span></div>
            </div>
          </div>
          <div class="project-content">
            <h3 class="project-title">HomeInspire</h3>
            <p class="project-description">Solution complète de gestion d’agence immobilière avec interface intuitive.</p>
            <div class="project-actions">
              <button class="project-btn" data-project="home-inspire" type="button">
                <i class="fas fa-eye" aria-hidden="true"></i>
                <span>Voir le projet</span>
              </button>
              <a class="project-btn secondary" href="https://github.com/RamyBenali/HomeInspire" target="_blank" rel="noopener">
                <i class="fab fa-github" aria-hidden="true"></i>
                <span>Code</span>
              </a>
            </div>
          </div>
        </article>

        <!-- Project 4 -->
        <article class="project-card">
          <div class="project-image" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);">
            <img class="saldaetrip-logo-img" src="../assets/images/SaldaeTrip.jpg" alt="SaldaeTrip" />
            <div class="project-overlay" aria-hidden="true">
              <div class="project-tech"><span>Kotlin</span><span>Dart</span><span>Android</span><span>Floater</span><span>MySQL</span><span>SupaBase</span></div>
            </div>
          </div>
          <div class="project-content">
            <h3 class="project-title">SaldaeTrip</h3>
            <p class="project-description">Application touristique pour découvrir Béjaïa et ses meilleures adresses.</p>
            <div class="project-actions">
              <button class="project-btn" data-project="saldae-trip" type="button">
                <i class="fas fa-eye" aria-hidden="true"></i>
                <span>Voir le projet</span>
              </button>
              <a class="project-btn secondary" href="https://github.com/RamyBenali/SaldaeTrip" target="_blank" rel="noopener">
                <i class="fab fa-github" aria-hidden="true"></i>
                <span>Code</span>
              </a>
            </div>
          </div>
        </article>
      </div>
    </div>
  </section>

  <!-- Compétences -->
  <section id="skills" class="skills-section" aria-labelledby="skills-title">
    <div class="container">
      <h2 class="section-title" id="skills-title">Mes <span class="accent">Compétences</span></h2>
      <div class="skills-grid">
        <div class="skill-category">
          <h3>Frontend</h3>
          <div class="skills-list">
            <div class="skill-item">
              <span class="skill-name">React</span>
              <div class="skill-bar"><div class="skill-progress" data-level="60"></div></div>
            </div>
            <div class="skill-item">
              <span class="skill-name">JavaFX</span>
              <div class="skill-bar"><div class="skill-progress" data-level="95"></div></div>
            </div>
            <div class="skill-item">
              <span class="skill-name">HTML et CSS</span>
              <div class="skill-bar"><div class="skill-progress" data-level="90"></div></div>
            </div>
          </div>
        </div>

        <div class="skill-category">
          <h3>Backend</h3>
          <div class="skills-list">
            <div class="skill-item">
              <span class="skill-name">Node.js</span>
              <div class="skill-bar"><div class="skill-progress" data-level="75"></div></div>
            </div>
            <div class="skill-item">
              <span class="skill-name">Python</span>
              <div class="skill-bar"><div class="skill-progress" data-level="80"></div></div>
            </div>
            <div class="skill-item">
              <span class="skill-name">MySQL</span>
              <div class="skill-bar"><div class="skill-progress" data-level="70"></div></div>
            </div>
          </div>
        </div>

        <div class="skill-category">
          <h3>Outils</h3>
          <div class="skills-list">
            <div class="skill-item">
              <span class="skill-name">Git</span>
              <div class="skill-bar"><div class="skill-progress" data-level="90"></div></div>
            </div>
            <div class="skill-item">
              <span class="skill-name">Flutter</span>
              <div class="skill-bar"><div class="skill-progress" data-level="80"></div></div>
            </div>
            <div class="skill-item">
              <span class="skill-name">Figma</span>
              <div class="skill-bar"><div class="skill-progress" data-level="95"></div></div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Footer -->
  <footer class="dev-footer">
    <div class="container footer-grid">
      <div class="footer-brand">
        <a class="footer-logo" href="#top" aria-label="Accueil Ramy Benali">
          <span class="dot"></span>
          <span>Ramy Benali</span>
        </a>
        <p class="footer-tag">Création d'expériences digitales élégantes et performantes.</p>
      </div>

      <nav class="footer-links" aria-label="Liens utiles">
        <h3>Navigation</h3>
        <ul>
          <li><a href="#projects">Projets</a></li>
          <li><a href="#skills">Compétences</a></li>
          <li><a href="about.html">À propos</a></li>
        </ul>
      </nav>

      <div class="footer-contact">
        <button class="modal-link" data-open-contact aria-controls="contact-panel" aria-expanded="false">Me contacter</button>
        <div class="footer-social" aria-label="Réseaux sociaux">
          <a href="https://github.com/RamyBenali" target="_blank" rel="noopener" aria-label="GitHub">
            <svg viewBox="0 0 24 24" width="22" height="22" aria-hidden="true"><path fill="currentColor" d="M12 .5A11.5 11.5 0 0 0 .5 12.4c0 5.2 3.3 9.6 7.8 11.1.6.1.8-.3.8-.6v-2c-3.2.7-3.9-1.4-3.9-1.4-.5-1.2-1.2-1.6-1.2-1.6-1-.7.1-.7.1-.7 1.1.1 1.6 1.2 1.6 1.2 1 1.8 2.7 1.3 3.4 1 .1-.7.4-1.3.7-1.6-2.6-.3-5.3-1.3-5.3-5.9 0-1.3.5-2.4 1.2-3.3-.1-.3-.5-1.5.1-3.1 0 0 1-.3 3.3 1.2a11.2 11.2 0 0 1 6 0c2.3-1.5 3.3-1.2 3.3-1.2.6 1.6.2 2.8.1 3.1.8.9 1.2 2 1.2 3.3 0 4.6-2.7 5.6-5.3 5.9.4.3.8 1 .8 2v3c0 .3.2.7.8.6a11.6 11.6 0 0 0 7.7-11C23.5 5.7 18.4.5 12 .5Z"/></svg>
          </a>
          <a href="https://www.linkedin.com/in/ramy-benali-248b70282" target="_blank" rel="noopener" aria-label="LinkedIn">
            <svg viewBox="0 0 24 24" width="22" height="22" aria-hidden="true"><path fill="currentColor" d="M20.45 20.45h-3.56v-5.5c0-1.31-.02-3-1.83-3-1.83 0-2.11 1.43-2.11 2.91v5.59H9.39V9.75h3.41v1.46h.05c.48-.91 1.65-1.87 3.4-1.87 3.64 0 4.31 2.39 4.31 5.49v5.62ZM5.34 8.29a2.07 2.07 0 1 1 0-4.14 2.07 2.07 0 0 1 0 4.14ZM7.12 20.45H3.56V9.75h3.56v10.7Z"/></svg>
          </a>
        </div>
      </div>
    </div>

    <div class="footer-bottom">
      <div class="container footer-bottom-inner">
        <p>© 2025 Ramy Benali. Tous droits réservés.</p>
        <button class="to-top" type="button" aria-label="Revenir en haut">↑</button>
      </div>
    </div>
  </footer>

  <!-- Panneau de contact -->
  <section id="contact-panel" class="contact-panel" aria-hidden="true">
    <div class="contact-card container">
      <button class="contact-close" type="button" aria-label="Fermer le formulaire">&times;</button>
      <header class="contact-header">
        <h2>Entrons en contact</h2>
        <p>Dites-moi l'essentiel et je reviendrai vers vous</p>
      </header>

      <form id="contact-form" novalidate>
        <input type="text" name="company" class="hp-field" tabindex="-1" autocomplete="off" />

        <div class="form-grid">
          <div class="form-field">
            <label for="name">Nom</label>
            <input id="name" name="name" type="text" placeholder="Votre nom" required />
            <span class="field-msg"></span>
          </div>

          <div class="form-field">
            <label for="email">Email</label>
            <input id="email" name="email" type="email" placeholder="nom@domaine.com" required />
            <span class="field-msg"></span>
          </div>

          <div class="form-field">
            <label for="subject">Sujet</label>
            <select id="subject" name="subject" required>
              <option value="">Choisir un sujet</option>
              <option value="Personnel">Projet personnel</option>
              <option value="Entreprise">Projet entreprise</option>
              <option value="Autre">Autre</option>
            </select>
            <span class="field-msg"></span>
          </div>

          <div class="form-field form-field--full">
            <label for="message">Message</label>
            <textarea id="message" name="message" rows="6" placeholder="Décrivez votre besoin" required></textarea>
            <span class="field-msg"></span>
          </div>
        </div>
        <!-- Remplace par TA site key publique Turnstile -->
        <!-- champ caché pour le token -->
        <input type="hidden" id="cf-token" name="token" value="">

        <!-- Turnstile (avec callbacks) -->
        <div class="cf-turnstile"
          data-sitekey="TA_SITE_KEY_PUBLIQUE"
          data-callback="onTurnstileSuccess"
          data-error-callback="onTurnstileError"
          data-expired-callback="onTurnstileExpired"></div>
        <script src="https://challenges.cloudflare.com/turnstile/v0/api.js" async defer></script>
        <script>
          window.onTurnstileSuccess = (token) => { document.getElementById('cf-token').value = token; };
          window.onTurnstileExpired = () => { document.getElementById('cf-token').value = ''; };
          window.onTurnstileError   = () => { document.getElementById('cf-token').value = ''; };
        </script>

        <div class="form-actions">
          <button id="send-btn" class="cta-btn primary" type="submit">Envoyer</button>
          <p class="form-status" role="status" aria-live="polite"></p>
        </div>
      </form>
    </div>
  </section>
  <script>
  // Callbacks Turnstile
  window.onTurnstileSuccess = (token) => {
    document.getElementById('cf-token').value = token;
  };
  window.onTurnstileExpired = () => { document.getElementById('cf-token').value = ''; };
  window.onTurnstileError   = () => { document.getElementById('cf-token').value = ''; };

  (function () {
    const form     = document.getElementById('contact-form');
    const sendBtn  = document.getElementById('send-btn');
    const statusEl = document.querySelector('.form-status');

    form.addEventListener('submit', async (e) => {
      e.preventDefault();

      // anti-bot + validation rapide
      const token = document.getElementById('cf-token').value;
      if (!token) { statusEl.textContent = "Vérification anti-bot requise."; return; }

      const payload = {
        name:    document.getElementById('name').value.trim(),
        email:   document.getElementById('email').value.trim(),
        subject: document.getElementById('subject').value.trim(),
        message: document.getElementById('message').value.trim(),
        token   // Turnstile
      };

      sendBtn.disabled = true;
      statusEl.textContent = "Envoi en cours...";

      try {
        // ➜ adapte le chemin si ton fichier est dans /api/contact.php
        const res  = await fetch('/contact.php', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(payload)
        });
        const data = await res.json().catch(() => ({}));

        if (!res.ok || data.ok === false) {
          const msg = (data && (data.error || data.body || data.details)) || 'Erreur serveur';
          statusEl.textContent = `Échec : ${msg}`;
        } else {
          statusEl.textContent = 'Message envoyé. Merci !';
          form.reset();
        }
      } catch (err) {
        statusEl.textContent = `Erreur réseau : ${String(err)}`;
      } finally {
        sendBtn.disabled = false;
        try { turnstile.reset(); } catch {}
        document.getElementById('cf-token').value = '';
      }
    });
  })();
</script>


  <!-- Modale projet -->
  <div class="project-modal" id="projectModal" aria-hidden="true">
    <div class="modal-content" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
      <button class="modal-close" id="modalClose" type="button" aria-label="Fermer la modale">
        <i class="fas fa-times" aria-hidden="true"></i>
      </button>

      <div class="modal-header">
        <h2 class="modal-title" id="modalTitle">Titre du Projet</h2>
        <div class="modal-tech" id="modalTech"></div>
      </div>

      <div class="modal-slider">
        <div class="slider-container" id="sliderContainer"></div>
        <button class="slider-arrow slider-prev" type="button" aria-label="Précédent"><i class="fas fa-chevron-left" aria-hidden="true"></i></button>
        <button class="slider-arrow slider-next" type="button" aria-label="Suivant"><i class="fas fa-chevron-right" aria-hidden="true"></i></button>
        <div class="slider-dots" id="sliderDots" aria-hidden="true"></div>
      </div>

      <div class="modal-body">
        <div class="modal-description" id="modalDescription"></div>
        <div class="modal-features">
          <h3>Fonctionnalités</h3>
          <ul id="modalFeatures"></ul>
        </div>
        <div class="modal-links">
          <a class="modal-link github-repo" id="githubRepoLink" href="#" target="_blank" rel="noopener">
            <i class="fab fa-github" aria-hidden="true"></i>
            <span>Code source GitHub</span>
          </a>
        </div>
      </div>
    </div>
  </div>

  <!-- Scripts -->
  <script src="../scripts/dev-page.js" defer></script>
  <script>
    // Bouton retour en haut
    document.querySelector('.to-top')?.addEventListener('click', function(){
      window.scrollTo({ top: 0, behavior: 'smooth' });
    });

    // Ouverture panneau contact
    (function(){
      const panel   = document.getElementById('contact-panel');
      const openers = document.querySelectorAll('[data-open-contact]');
      const closeBtn= panel?.querySelector('.contact-close');
      const form    = document.getElementById('contact-form');
      const sendBtn = document.getElementById('send-btn');
      const statusEl= panel?.querySelector('.form-status');

      if(!panel || !form) return;

      function openPanel(){
        panel.classList.add('active');
        panel.setAttribute('aria-hidden','false');
        openers.forEach(b=>b.setAttribute('aria-expanded','true'));
        setTimeout(()=>document.getElementById('name')?.focus(), 120);
      }
      function closePanel(){
        panel.classList.remove('active');
        panel.setAttribute('aria-hidden','true');
        openers.forEach(b=>b.setAttribute('aria-expanded','false'));
      }
      openers.forEach(btn=>btn.addEventListener('click', e=>{ e.preventDefault(); openPanel(); }));
      closeBtn?.addEventListener('click', closePanel);
      panel.addEventListener('click', e=>{ if(e.target === panel) closePanel(); });
      document.addEventListener('keydown', e=>{ if(e.key === 'Escape') closePanel(); });

      function validate(){
        let ok = true;
        form.querySelectorAll('.form-field').forEach(f=>{
          const input = f.querySelector('input, select, textarea');
          const msg   = f.querySelector('.field-msg');
          if(input && !input.checkValidity()){
            ok = false;
            if(msg) msg.textContent = 'Champ requis ou invalide';
          }else if(msg){ msg.textContent = ''; }
        });
        return ok;
      }

      form.addEventListener('submit', async e=>{
        e.preventDefault();
        if(!validate()) return;
        if(form.company && form.company.value) return;

        sendBtn.disabled = true;
        if(statusEl) statusEl.textContent = 'Envoi en cours...';

        // Placeholder d’envoi. Branchez votre /api/contact plus tard.
        try {
          const token = document.getElementById('cf-token')?.value || '';
          if (!token) {
            if (statusEl) statusEl.textContent = "Vérification anti-bot requise. Merci de cocher le widget.";
            sendBtn.disabled = false;
            return;
          }

          const payload = {
            name:    document.getElementById('name').value.trim(),
            email:   document.getElementById('email').value.trim(),
            subject: document.getElementById('subject').value.trim(),
            message: document.getElementById('message').value.trim(),
            token
          };

          // ⚠️ URL Pages Functions :
          // un fichier /functions/contact.js => endpoint public /contact (pas /functions/contact)
          const res = await fetch('/contact', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(payload)
          });

          const data = await res.json().catch(()=> ({}));

          if (!res.ok || data.ok === false) {
            const msg = (data && (data.error || data.body || data.details)) || 'Erreur serveur';
            if (statusEl) statusEl.textContent = `Échec de l’envoi : ${msg}`;
          } else {
            if (statusEl) statusEl.textContent = 'Message envoyé. Merci, je reviens vers vous rapidement.';
            form.reset();
          }
        } catch (err) {
          if (statusEl) statusEl.textContent = `Erreur réseau : ${String(err)}`;
        } finally {
          sendBtn.disabled = false;
          // Réinitialise le widget pour regénérer un token pour un prochain envoi
          try { turnstile.reset(); } catch {}
          document.getElementById('cf-token').value = '';
        }
      });
    })();

    // Menu mobile basique
    window.addEventListener('DOMContentLoaded', () => {
      const toggle  = document.getElementById('mobile-menu');
      const drawer  = document.getElementById('mobile-drawer');
      const overlay = document.getElementById('drawer-overlay');

      if(!toggle || !drawer || !overlay) return;

      function openDrawer(){
        drawer.classList.add('is-open');
        overlay.classList.add('is-open');
        overlay.hidden = false;
        document.body.classList.add('body-no-scroll');
        toggle.setAttribute('aria-expanded','true');
        drawer.setAttribute('aria-hidden','false');
      }
      function closeDrawer(){
        drawer.classList.remove('is-open');
        overlay.classList.remove('is-open');
        document.body.classList.remove('body-no-scroll');
        toggle.setAttribute('aria-expanded','false');
        drawer.setAttribute('aria-hidden','true');
        setTimeout(()=>{ overlay.hidden = true; }, 250);
      }

      toggle.addEventListener('click', () => {
        drawer.classList.contains('is-open') ? closeDrawer() : openDrawer();
      });
      overlay.addEventListener('click', closeDrawer);
      drawer.querySelector('.drawer-close')?.addEventListener('click', closeDrawer);

      drawer.addEventListener('click', (e)=>{
        if(e.target.closest('a, button[data-open-contact]')) closeDrawer();
      });
      document.addEventListener('keydown', (e)=>{
        if(e.key === 'Escape' && drawer.classList.contains('is-open')) closeDrawer();
      });
    });
  </script>
<script>
(function () {
  const navH = document.querySelector('.navbar')?.offsetHeight ?? 0;

  // Easing douce
  const easeInOutCubic = t => (t < 0.5)
      ? 4 * t * t * t
      : 1 - Math.pow(-2 * t + 2, 3) / 2;

  function smoothScrollTo(targetY, opts = {}) {
    const prefersReduced = window.matchMedia('(prefers-reduced-motion: reduce)').matches;
    if (prefersReduced) { window.scrollTo(0, targetY); return; }

    const startY   = window.scrollY || window.pageYOffset;
    const delta    = targetY - startY;
    // Durée auto: 0.4ms par px, bornée entre 450ms et 1200ms
    const duration = Math.max(450, Math.min(1200, Math.abs(delta) * 0.4));
    const start    = performance.now();

    function frame(now) {
      const t = Math.min(1, (now - start) / duration);
      const eased = easeInOutCubic(t);
      window.scrollTo(0, startY + delta * eased);
      if (t < 1) requestAnimationFrame(frame);
      else if (opts.onComplete) opts.onComplete();
    }
    requestAnimationFrame(frame);
  }

  // Délégation: capte tous les liens internes (header, drawer, footer…)
  document.addEventListener('click', (e) => {
    const a = e.target.closest('a[href^="#"]');
    if (!a) return;

    const id = a.getAttribute('href');
    const target = document.querySelector(id);
    if (!target) return; // (#contact peut ouvrir une modale; laisse ton autre JS gérer)
    e.preventDefault();

    const y = target.getBoundingClientRect().top + window.scrollY - navH;

    smoothScrollTo(y, {
      onComplete: () => {
        // focus accessible sans ressaut
        target.setAttribute('tabindex', '-1');
        target.focus({ preventScroll: true });

        // ferme le menu mobile si ouvert
        const drawer  = document.getElementById('mobile-drawer');
        const overlay = document.getElementById('drawer-overlay');
        if (drawer?.classList.contains('is-open')) {
          drawer.classList.remove('is-open');
          overlay?.classList.remove('is-open');
          document.body.classList.remove('body-no-scroll');
          setTimeout(() => overlay?.setAttribute('hidden',''), 250);
        }
      }
    });
  });
})();
</script>

  <!-- Overlay cliquable (20%) -->
<div id="drawer-overlay" class="drawer-overlay" hidden></div>

<!-- Menu mobile off-canvas -->
<aside id="mobile-drawer" class="mobile-drawer" aria-hidden="true" aria-labelledby="drawer-title">
  <header class="drawer-header">
    <h2 id="drawer-title">Menu</h2>
    <button type="button" class="drawer-close" aria-label="Fermer le menu">×</button>
  </header>

  <nav class="drawer-nav" role="navigation">
    <a class="nav-link" href="../index.html">Accueil</a>
    <a class="nav-link" href="#projects">Projets</a>
    <a class="nav-link" href="#skills">Compétences</a>
    <a class="nav-link" href="about.html">À propos</a>
    <a class="nav-link" href="#contact" data-open-contact>Contact</a>
    <a class="mode-toggle is-dev" aria-label="Basculer entre mode Développeur et Créatif">
      <span class="toggle-half half-dev" aria-current="page">Dev</span>
      <span class="toggle-thumb" aria-hidden="true"></span>
      <span class="toggle-half half-crea" onclick="location.href='creative.html'">Créa</span>
    </a>
  </nav>  

  <div class="drawer-footer">
    <a class="drawer-cta" href="#contact" data-open-contact>
      <i class="fas fa-paper-plane" aria-hidden="true"></i> Me contacter
    </a>
    <div class="drawer-socials">
      <a href="https://github.com/RamyBenali" target="_blank" rel="noopener" aria-label="GitHub"><i class="fab fa-github"></i></a>
      <a href="https://www.linkedin.com/in/ramy-benali-248b70282" target="_blank" rel="noopener" aria-label="LinkedIn"><i class="fab fa-linkedin-in"></i></a>
      <a href="https://www.instagram.com/rmba.exe/" target="_blank" rel="noopener" aria-label="Instagram"><i class="fab fa-instagram"></i></a>
    </div>
  </div>
</aside>

  <!-- i18n ADD: switch langue + import des fichiers i18n -->
  <div class="lang-switch" aria-label="Language switch">
    <input type="checkbox" id="lang-toggle" aria-label="Toggle language">
    <label for="lang-toggle" class="lang-toggle" title="FR / EN">
      <span class="lang-pill">FR</span>
      <span class="lang-pill">EN</span>
      <span class="thumb">FR</span>
    </label>
  </div>

  <script src="../assets/i18n/dev-translations.js" defer></script>
  <script src="../assets/i18n/dev-i18n.js" defer></script>
  <!-- /i18n ADD -->
</body>
</html>